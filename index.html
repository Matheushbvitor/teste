<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Convite Especial</title>
  <style>
    body{
      margin:0; min-height:100vh; background:#ffffff;
      background-image:url("IMG_20250823_124847408.jpg");
      background-size:contain; background-position:center; background-repeat:no-repeat;
      display:grid; place-items:center; padding:20px; text-align:center; font-family:sans-serif;
    }

    .card{
      position:relative;
      width:min(980px,96vw);
      background:rgba(0,0,0,.45);
      color:#fff; padding:28px 24px; border-radius:16px; text-align:center;
      backdrop-filter:blur(2px); box-shadow:0 10px 30px rgba(0,0,0,.25);
    }

    h1.title{ margin:0 0 18px; font-size:42px; font-weight:700; line-height:1.15; color:#fff; text-shadow:0 1px 2px rgba(0,0,0,.55); }
    .title-emoji{ display:inline-block; transition:opacity .26s ease; will-change:opacity; }

    .typing{
      font-size:22px; max-width:100%; line-height:1.6; color:#fff; text-align:center;
      border-right:2px solid rgba(255,255,255,.9); animation:blink-caret .75s step-end infinite;
      white-space:pre-wrap; margin:0 auto 14px; text-shadow:0 1px 2px rgba(0,0,0,.55);
    }
    @keyframes blink-caret{ 50%{ border-color:transparent } }
    @media (min-width:1200px){ .typing{font-size:24px} .title{font-size:48px} }

    .button-container{ display:flex; gap:20px; flex-wrap:wrap; justify-content:center; margin-top:10px; }
    .btn{ padding:15px 25px; font-size:18px; border:none; border-radius:10px; cursor:pointer; transition:transform .15s ease,filter .15s ease; }
    .btn:active{ transform:scale(.98) } .btn:hover{ filter:brightness(1.06) }
    .yes{ background:#4CAF50; color:#fff } .no{ background:#f44336; color:#fff } .why{ background:#ff9800; color:#fff }
    .btn .emo{ margin-left:.35em; display:inline-block; transform:translateY(1px) }

    .dialog-overlay{ display:none; position:fixed; inset:0; background:rgba(0,0,0,.5); justify-content:center; align-items:center; padding:16px; }
    .dialog-box{ width:min(360px,92vw); background:rgba(255,255,255,.96); border-radius:12px; padding:20px; text-align:center; box-shadow:0 12px 36px rgba(0,0,0,.35); backdrop-filter:blur(2px); }
    .dialog-box p{ margin:0 0 16px; font-size:18px; color:#333 } .dialog-buttons{ display:flex; gap:12px; } .dialog-buttons button{ flex:1; padding:10px 0; border:none; border-radius:8px; font-size:16px; cursor:pointer }
    @keyframes shake{0%{transform:translateX(0)}25%{transform:translateX(-5px)}50%{transform:translateX(5px)}75%{transform:translateX(-5px)}100%{transform:translateX(0)}}
    .shaking{ animation:shake .3s }

    /* Bloco de acr√¥nimo (se usado) */
    #acronymFull{
      width: min(860px, 92vw);
      margin: 16px auto 0;
      padding: 12px 16px;
      background: rgba(255,255,255,.06);
      border-radius: 12px;
      font-size: clamp(15px, 1.8vw, 19px);
      line-height: 1.6;
      transition: height 140ms ease, opacity 120ms ease;
      will-change: height, opacity;
      overflow: hidden;
      text-align:left;
    }
    #acronymFull .row{ display:flex; align-items:center; gap:10px; margin:2px 0; }
    #acronymFull .letter{
      width:28px; height:28px; flex:0 0 28px;
      border-radius:8px; background:rgba(255,255,255,.92); color:#222;
      font-weight:800; font-size:14px;
      display:flex; align-items:center; justify-content:center;
      box-shadow:0 4px 12px rgba(0,0,0,.25);
    }
    #acronymFull .text{ flex:1; }
  </style>
</head>
<body>
  <div class="card">
    <h1 class="title">Oi Mari <span id="emojiCycler" class="title-emoji" aria-hidden="true">üòç</span></h1>

    <p id="textoDigitado" class="typing"></p>

    <div class="button-container">
      <button class="btn yes" onclick="aceitou()">Tenho chance! <span class="emo" role="img" aria-label="rosto apaixonado">ü•∞</span></button>
      <button class="btn no"  onclick="abrirDialogo()">N√£o tenho chance! <span class="emo" role="img" aria-label="triste">üôÅ</span></button>
    </div>

    <div class="button-container" style="margin-top: 20px;">
      <button id="whyBtn" class="btn why" onclick="abrirPagina()">Por que eu quero uma chance? ü§î</button>
    </div>

    <section id="acronymFull" aria-live="polite" aria-atomic="true"></section>
  </div>

  <div class="dialog-overlay" id="dialogo">
    <div class="dialog-box">
      <p>Voc√™ tem certeza?</p>
      <div class="dialog-buttons" id="dialogButtons">
        <button id="btnSim" class="yes" onclick="tremerETrocar(event)">SIM</button>
        <button id="btnNao" class="no"  onclick="fecharDialogo()">N√ÉO</button>
      </div>
    </div>
  </div>

  <!-- √Åudios locais na MESMA PASTA -->
  <audio id="feliznavida-audio" preload="auto">
    <source src="feliznavida.mp3" type="audio/mpeg">
  </audio>
  <audio id="sadsong-audio" preload="auto">
    <source src="sadsong.mp3" type="audio/mpeg">
  </audio>

  <script>
    /* ===== util gen√©rico para tocar √°udio (com logs) ===== */
    async function playFromElementOrNew(id, src, volume = 0.5, label = '') {
      // tenta pelo elemento existente
      const el = document.getElementById(id);
      const tryPlay = async (audio, how) => {
        try {
          audio.volume = volume;
          audio.currentTime = 0;
          await audio.play();
          console.log(`[OK] √Åudio tocando via ${how}${label ? ' ('+label+')' : ''}`);
          return true;
        } catch (err) {
          console.warn(`[ERRO] Falha ao tocar via ${how}:`, err);
          return false;
        }
      };

      if (el) {
        el.onerror = () => console.warn(`[ERRO] onerror do <audio id="${id}"> (verifique nome/caminho: ${src}).`);
        if (await tryPlay(el, `<audio>#${id}`)) return true;
      } else {
        console.warn(`[INFO] <audio id="${id}"> n√£o encontrado no DOM.`);
      }

      // fallback din√¢mico
      const dyn = new Audio(src);
      dyn.preload = 'auto';
      return await tryPlay(dyn, `new Audio("${src}")`);
    }

    /* ===== Bot√µes/di√°logo ===== */
    async function aceitou(){
      // toca feliznavida.mp3 no clique do bot√£o verde
      await playFromElementOrNew('feliznavida-audio', 'feliznavida.mp3', 0.5, 'feliz');

      // redireciona ap√≥s 4,5 s
      setTimeout(()=>{
        const msg = encodeURIComponent("Aceitei :)");
        window.location.href = `https://wa.me/5518996259121?text=${msg}`;
      }, 4500);
    }

    function abrirPagina(){ window.location.href = "pagina.html"; }

    async function abrirDialogo(){
      // toca sadsong.mp3 no clique do bot√£o vermelho
      playFromElementOrNew('sadsong-audio', 'sadsong.mp3', 0.5, 'sad');

      const cont = document.getElementById('dialogButtons');
      const sim  = document.getElementById('btnSim');
      const nao  = document.getElementById('btnNao');
      cont.innerHTML = ''; cont.appendChild(sim); cont.appendChild(nao);
      document.getElementById('dialogo').style.display = 'flex';
    }

    function fecharDialogo(){ document.getElementById('dialogo').style.display = 'none'; }

    function tremerETrocar(e){
      e.preventDefault(); e.stopPropagation();
      const sim=document.getElementById('btnSim');
      sim.classList.add('shaking');
      sim.addEventListener('animationend', ()=>{ sim.classList.remove('shaking'); trocarLugar(); }, {once:true});
    }
    function trocarLugar(){
      const cont=document.getElementById('dialogButtons');
      const sim=document.getElementById('btnSim');
      const nao=document.getElementById('btnNao');
      const simFirst=sim.getBoundingClientRect(), naoFirst=nao.getBoundingClientRect();
      if (sim.nextElementSibling===nao) cont.insertBefore(nao,sim); else cont.insertBefore(sim,nao);
      const simLast=sim.getBoundingClientRect(), naoLast=nao.getBoundingClientRect();
      animateSlide(sim, simFirst.left-simLast.left); animateSlide(nao, naoFirst.left-naoLast.left);
    }
    function animateSlide(el, dx){
      el.style.transition='none'; el.style.transform=`translateX(${dx}px)`; el.getBoundingClientRect();
      requestAnimationFrame(()=>{ el.style.transition='transform 220ms ease'; el.style.transform='translateX(0)'; });
    }

    /* ===== Texto com cora√ß√£o/letra ===== */
    const texto =
`Acho que t√¥ precisando de terapia‚Ä¶ ando com uns sintomas meio suspeitos: cora√ß√£o acelerado, sorriso bobo e uma vontade de te ver todo dia.
Sinceramente? T√¥ come√ßando a desconfiar que o diagn√≥stico √© voc√™.
Com todo respeito, √© claro‚Ä¶ mas ser√° que eu teria alguma chance com voc√™?`;

    const destino = document.getElementById("textoDigitado");
    let index = 0;

    /* 15% mais r√°pido */
    const BASE_INTERVAL = 18;   // 21 * 0.85
    const COMMA_PAUSE   = 27;   // 32 * 0.85
    const SENTENCE_PAUSE= 56;   // 66 * 0.85
    const REVEAL_DELAY  = 133;  // 157 * 0.85
    const FADE_DURATION = 40;   // 47 * 0.85

    function nextDelayFor(c){
      if (c===','||c===';') return BASE_INTERVAL+COMMA_PAUSE;
      if ('.!?‚Ä¶'.includes(c)) return BASE_INTERVAL+SENTENCE_PAUSE;
      return BASE_INTERVAL;
    }
    function digitarSequencial(){
      if (index>=texto.length){ destino.style.borderRight='none'; return; }
      const c = texto.charAt(index);
      if (c===' '){ destino.append(' '); index++; return setTimeout(digitarSequencial, BASE_INTERVAL); }
      if (c==='\n'){ destino.appendChild(document.createElement('br')); index++; return setTimeout(digitarSequencial, BASE_INTERVAL+SENTENCE_PAUSE); }
      const span=document.createElement('span');
      span.textContent='‚ù§Ô∏è'; span.style.display='inline'; span.style.opacity='1';
      span.style.transition=`opacity ${FADE_DURATION}ms ease`; destino.appendChild(span);
      setTimeout(()=>{ 
        span.style.opacity='0'; 
        setTimeout(()=>{ 
          span.textContent=c; 
          span.style.opacity='1'; 
          index++; 
          setTimeout(digitarSequencial,nextDelayFor(c)); 
        }, FADE_DURATION); 
      }, REVEAL_DELAY);
    }

    /* ===== Emoji do t√≠tulo ===== */
    const emojiList=["ü§©","ü•∞","üòç","üíñ"], emojiEl=document.getElementById("emojiCycler"); let emojiIndex=0;
    function cycleEmoji(){ emojiEl.style.opacity='0'; setTimeout(()=>{ emojiIndex=(emojiIndex+1)%emojiList.length; emojiEl.textContent=emojiList[emojiIndex]; emojiEl.style.opacity='1'; },260); }

    /* ===== (Opcional) dados dos acr√¥nimos e rotador (mantidos) ===== */
    const ACRONYM_BLOCK = `
---ACRONIMOS_POR_LETRA---
[M]
- Meu motivo de sorrir
- Minha palmeirense preferida
- Melodia suave da vida
- Meu porto seguro
- Minha zoeira favorita
- Minha camisa 10
- Modelo √∫nico
- Motivada e focada
- Meu melhor lugar no mundo
- Meu mundo fica melhor com voc√™
- Meu sorriso preferido mora em voc√™
- Minha dose di√°ria de dopamina
- Maravilhosa

[A]
- Amor em cada gesto
- A √∫nica terapia que eu quero √© estar ao seu lado
- An√°lise nenhuma explica o que sinto por voc√™
- Alegria que contagia
- A √∫nica que quero ao meu lado
- Adora dar bronca (rs)
- Apaixonante
- Atrapalha meu cora√ß√£o (faz ele errar as batidas rs)
- Alma linda que encanta
- Aut√™ntica em cada gesto
- Amo seus surtinhos (fofos)
- Abrigo contra qualquer tempestade
- Amiga
- Admir√°vel
- Amo
- Admirada
- A refer√™ncia que eu admiro
- Amanhecer mais bonito ao seu lado
- Amor que nenhum teste de Rorschach disfar√ßa

[R]
- Raz√£o das minhas melhores inspira√ß√µes
- Refer√™ncia nos meus sonhos (at√© o Jung concordaria)
- Risada fofa
- Rara e preciosa
- Respons√°vel e brilhante
- Respiro aliviado quando te vejo
- Romance que eu quero viver
- Rosto que ilumina meus dias

[I]
- Ilumina qualquer ambiente
- Insight mais lindo da minha vida
- Incrivelmente gente boa
- Irrepreens√≠vel no car√°ter
- Imposs√≠vel n√£o te notar
- Incompar√°vel na ess√™ncia
- Intelig√™ncia que encanta
- Imensa no cora√ß√£o
- Inesquec√≠vel

[N]
- Ningu√©m se compara a voc√™
- Nem Freud explica minha atra√ß√£o por voc√™
- Nunca perde o charme
- Na medida exata do meu sonho
- Not√°vel por onde passa
- Nocaute no meu cora√ß√£o
- N√≠vel m√°ximo de encanto
- Nunca te trocaria por nada
- Nos meus planos, sempre voc√™
---FIM---
`;

    function parseGroup(block, letter){
      const re = new RegExp(`\\[${letter}\\]([\\s\\S]*?)(?=\\n\\[|---FIM---)`, 'm');
      const m = block.match(re);
      if(!m) return [];
      return m[1].split('\n').map(l => l.replace(/^\s*-\s*/, '').trim()).filter(Boolean);
    }
    const GROUPS = {
      M: parseGroup(ACRONYM_BLOCK, 'M'),
      A: parseGroup(ACRONYM_BLOCK, 'A'),
      R: parseGroup(ACRONYM_BLOCK, 'R'),
      I: parseGroup(ACRONYM_BLOCK, 'I'),
      N: parseGroup(ACRONYM_BLOCK, 'N'),
    };

    function pickOne(arr, avoid){ const pool = arr.filter(x => x !== avoid); return pool.length ? pool[Math.floor(Math.random()*pool.length)] : (arr[0] || ''); }
    function pickDistinctA(aArr, usedSet, avoid){
      const pool = aArr.filter(x => !usedSet.has(x) && x !== avoid);
      if(!pool.length){ const fb = aArr.filter(x => x !== avoid); return fb.length ? fb[Math.floor(Math.random()*fb.length)] : (aArr[0] || ''); }
      return pool[Math.floor(Math.random()*pool.length)];
    }

    function makeAcronymSets(count=20){
      const sets=[], lastByPos = Array(7).fill(null);
      for(let s=0; s<count; s++){
        const usedA = new Set();
        const l0 = pickOne(GROUPS.M, lastByPos[0]);
        const l1 = pickDistinctA(GROUPS.A, usedA, lastByPos[1]); usedA.add(l1);
        const l2 = pickOne(GROUPS.R, lastByPos[2]);
        const l3 = pickOne(GROUPS.I, lastByPos[3]);
        const l4 = pickDistinctA(GROUPS.A, usedA, lastByPos[4]); usedA.add(l4);
        const l5 = pickOne(GROUPS.N, lastByPos[5]);
        const l6 = pickDistinctA(GROUPS.A, usedA, lastByPos[6]);
        const set = [l0,l1,l2,l3,l4,l5,l6];
        for(let i=0;i<7;i++) lastByPos[i]=set[i];
        sets.push(set);
      }
      return sets;
    }

    let ACRONYM_SETS = [];
    let currentSet = 0;

    function renderFullAcronym(lines){
      const full = document.getElementById('acronymFull'); if(!full) return;
      const letters = ['M','A','R','I','A','N','A'];

      const wrapper = document.createElement('div');
      lines.forEach((txt, i)=>{
        const row = document.createElement('div'); row.className='row';
        const chip = document.createElement('div'); chip.className='letter'; chip.textContent = letters[i] || '';
        const span = document.createElement('div'); span.className='text'; span.textContent = txt;
        row.appendChild(chip); row.appendChild(span); wrapper.appendChild(row);
      });

      const measurer = full.cloneNode(false);
      measurer.style.cssText = 'position:absolute; visibility:hidden; pointer-events:none; left:-9999px; top:0; height:auto; opacity:1;';
      measurer.style.width = full.clientWidth + 'px';
      measurer.appendChild(wrapper.cloneNode(true));
      full.parentNode.appendChild(measurer);
      const newH = measurer.scrollHeight;
      measurer.remove();

      const currentH = full.offsetHeight;
      full.style.height = currentH + 'px';
      full.style.opacity = '0';
      full.innerHTML = '';
      full.appendChild(wrapper);

      requestAnimationFrame(()=>{ full.style.height = newH + 'px'; full.style.opacity = '1'; });

      const onEnd = (e)=>{ if(e.propertyName === 'height'){ full.style.height = 'auto'; full.removeEventListener('transitionend', onEnd); } };
      full.addEventListener('transitionend', onEnd);
    }

    function nextAcronym(){ currentSet = (currentSet + 1) % ACRONYM_SETS.length; renderFullAcronym(ACRONYM_SETS[currentSet]); }

    /* ===== Boot ===== */
    window.addEventListener('load', ()=>{
      digitarSequencial();
      setInterval(cycleEmoji, 5000);
      ACRONYM_SETS = makeAcronymSets(20);
      renderFullAcronym(ACRONYM_SETS[0]);

      let timer = setInterval(nextAcronym, 3000);
      document.addEventListener('visibilitychange', ()=>{
        if(document.visibilityState === 'visible'){ clearInterval(timer); timer = setInterval(nextAcronym, 3000); }
        else{ clearInterval(timer); }
      });
    });
  </script>
</body>
</html>
